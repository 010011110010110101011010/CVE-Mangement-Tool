{% load static %}
<!-- 
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Table</title>
  <link rel="shortcut icon" href="{% static 'images/favicon.png' %}" type="image/x-icon">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400&display=swap" rel="stylesheet">
  <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="{% static 'css/bootstrap-icons.css' %}" rel="stylesheet">
  <link href="{% static 'css/templatemo-tiya-golf-club.css' %}" rel="stylesheet">
  <style>
    .table-header-bold th {
      font-weight: bold;
    }
    .pagination-dropdown {
      margin-top: 20px;
    }
    .btn-refresh {
      background-color: rgb(61 64 91);
      color: white;
      border: none;
    }
    #loading {
    display: none; /* Hide loading screen by default */
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 1000;
    background: rgba(123, 120, 120, 0.8);
    padding: 20px;
    border-radius: 8px;
  }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg bg-custom" style="background-color: rgb(61 64 91); width:auto;">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="/main">
        <img src="{% static 'images/favicon.png' %}" class="navbar-brand-image img-fluid" alt="InSecTrace Tool">
        <span class="navbar-brand-text">
          InSecTrace
          <small>Tool</small>
        </span>
      </a>
      <div class="d-lg-none ms-auto me-3">
        <a class="btn custom-btn custom-border-btn" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button" aria-controls="offcanvasExample">Member Login</a>
      </div>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-lg-auto">
          <li class="nav-item">
            <a class="nav-link click-scroll" href="/main">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link click-scroll" href="/First_View">Data Samples</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  
  <div class="container mt-4">
    <div class="table-responsive">
      <div class="container mt-4">
        <div class="table-responsive">
          <form method="post" action="{% url 'fetch_and_store_bulletins' %}" class="d-inline" id="refresh-form">
            {% csrf_token %}
            <button type="submit" id="refresh-btn" class="btn btn-refresh">Refresh Data</button>
          </form>
          <div id="loading">
            <img id="loading-icon" src="{% static 'images/loading.gif' %}" alt="Loading..." />
          </div>
          <table class="table table-striped" style="width: auto;">
            </table>
        </div>
    
        <div class="d-flex justify-content-between">
          </div>
      </div>
      <table class="table table-striped" style="width: auto;">
        <thead>
          <tr class="table-header-bold">
            <th scope="col" class="text-center">Titre</th>
            <th scope="col" class="text-center">Date de Publication</th>
            <th scope="col" class="text-center">Numéro de Référence</th>
            <th scope="col" class="text-center">Plus De Details</th>
          </tr>
        </thead>
        <tbody>
          {% for item in data_list1 %}
            <tr>
              <td>{{ item.Titre }}</td>
              <td>{{ item.DatePub }}</td>
              <td>{{ item.NumRef }}</td>
              <td>
                <a href="{% url 'data_detail' %}?item_id={{ item.NumRef }}">
                  <button class="btn btn-primary" style="background-color: rgb(61 64 91);">Plus De Details</button>
                </a>
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="d-flex justify-content-between">
      <div class="pagination-dropdown" style="width: auto;">
        <form method="get" action="" class="d-flex align-items-center">
          <select id="page-select" name="page" class="form-select" aria-label="Page selection">
            {% for num in data_list1.paginator.page_range %}
              <option value="{{ num }}" {% if data_list1.number == num %}selected{% endif %}>Page {{ num }}</option>
            {% endfor %}
          </select>
          <button type="submit" class="btn btn-primary" style="background-color: rgb(61 64 91);">Go</button>
        </form>
      </div> 
    </div>
  </div>

  <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
  <script>
    const refreshForm = document.getElementById('refresh-form');
    const loadingElement = document.getElementById('loading');
  
    refreshForm.addEventListener('submit', function() {
      // Show loading screen
      loadingElement.style.display = 'block';
    });
  </script>
</body>
</html> -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Data Table</title>
  <link rel="shortcut icon" href="{% static 'images/favicon.png' %}" type="image/x-icon">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400&display=swap" rel="stylesheet">
  <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
  <link href="{% static 'css/bootstrap-icons.css' %}" rel="stylesheet">
  <link href="{% static 'css/templatemo-tiya-golf-club.css' %}" rel="stylesheet">
  <style>
    .select {
      position: relative;
      z-index: 1000;
      visibility: visible;
    }
    .table-header-bold th {
      font-weight: bold;
    }
    .pagination-dropdown {
      margin-top: 20px;
    }
    .btn-refresh {
      background-color: rgb(61 64 91);
      color: white;
      border: none;
    }
    #loading {
      display: none; /* Hide loading screen by default */
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1000;
      background: rgba(123, 120, 120, 0.8);
      padding: 20px;
      border-radius: 8px;
    }
  </style>
</head>
<body>
  <nav class="navbar navbar-expand-lg bg-custom" style="background-color: rgb(61 64 91); width:auto;">
    <div class="container">
      <a class="navbar-brand d-flex align-items-center" href="/main">
        <img src="{% static 'images/favicon.png' %}" class="navbar-brand-image img-fluid" alt="InSecTrace Tool">
        <span class="navbar-brand-text">
          InSecTrace
          <small>Tool</small>
        </span>
      </a>
      <div class="d-lg-none ms-auto me-3">
        <a class="btn custom-btn custom-border-btn" data-bs-toggle="offcanvas" href="#offcanvasExample" role="button" aria-controls="offcanvasExample">Member Login</a>
      </div>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav ms-lg-auto">
          <li class="nav-item">
            <a class="nav-link click-scroll" href="/main">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link click-scroll" href="/dashboard">Dashboard</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>
  
  <div class="container mt-4">
    <div class="d-flex justify-content-start">
      <form method="post" action="{% url 'fetch_and_store_bulletins' %}" class="d-inline" id="refresh-form">
        {% csrf_token %}
        <!-- <button type="submit" id="refresh-btn" class="btn btn-refresh">Refresh Data</button> -->
      </form>
    </div>
    <div class="table-responsive">
      <div id="loading">
        <img id="loading-icon" src="{% static 'images/loading.gif' %}" alt="Loading..." />
      </div>

      {% for os in page_obj %}
      <h3>System: {{ os.os_name }}</h3>
        <table class="table table-striped" style="width: auto;">
          <thead>
            <tr class="table-header-bold">
              <th scope="col" class="text-center">Titre</th>
              <th scope="col" class="text-center">Date de Publication</th>
              <th scope="col" class="text-center">Numéro de Référence</th>
              <th scope="col" class="text-center">Plus De Details</th>
            </tr>
          </thead>
          <tbody>
            {% for item in os.articles %}
              <tr>
                <td>{{ item.title }}</td>
                <td>{{ item.publication_date }}</td>
                <td>{{ item.reference_number }}</td>
                <td>
                  <a href="{% url 'data_detail' %}?item_id={{ item.reference_number }}">
                    <button class="btn btn-primary" style="background-color: rgb(61 64 91);">Plus De Details</button>
                  </a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% endfor %}

      <div class="container">
        <div class="row justify-content-center my-4">
            <form method="get" action="" class="d-flex align-items-center">
                <label for="page-select" class="me-2 mb-0">Page:</label>
                <select id="page-select" name="page" class="form-select me-2" aria-label="Page selection">
                    {% for num in page_obj.paginator.page_range %}
                        <option value="{{ num }}" {% if num == page_obj.number %}selected{% endif %}>Page {{ num }}</option>
                    {% endfor %}
                </select>
                <button type="submit" class="btn btn-primary" style="background-color: rgb(61 64 91);">Go</button>
            </form>
        </div>
      </div>
  </div>

  <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
  <script>
    const refreshForm = document.getElementById('refresh-form');
    const loadingElement = document.getElementById('loading');
  
    refreshForm.addEventListener('submit', function() {
      // Show loading screen
      loadingElement.style.display = 'block';
    });
  </script>
</body>
</html>
